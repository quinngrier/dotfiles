#! /bin/sh -

export LC_ALL=C

case $#,$1 in
  1,--help)
    cat <<'EOF'
Usage: git u [<remote=upstream> [<branch=master>]]

Switches to <branch>, then fetches and merges it from <remote>.
EOF
    exit 0
  ;;
  0, | 1,* | 2,*)
    :
  ;;
  *)
    cat <<'EOF' >&2
Bad usage. Try "git-u --help" (not "git u --help").
EOF
    exit 1
  ;;
esac

readonly git="${GIT:-git}"

readonly remote="${1-upstream}"
readonly branch="${2-master}"

readonly message="Merge $remote/$branch into $branch"

eval " $git"' checkout "$branch"' || exit $?
eval " $git"' fetch -n "$remote" "$branch"' || exit $?
eval " $git"' merge -m "$message" "$remote/$branch"' || exit $?

exit 0

#
# The authors of this file have waived all copyright and
# related or neighboring rights to the extent permitted by
# law as described by the CC0 1.0 Universal Public Domain
# Dedication. You should have received a copy of the full
# dedication along with this file, typically as a file
# named <CC0-1.0.txt>. If not, it may be available at
# <https://creativecommons.org/publicdomain/zero/1.0/>.
#
